"use strict";(self["webpackChunkvue_week8"]=self["webpackChunkvue_week8"]||[]).push([[182],{4182:function(e,s,t){t.r(s),t.d(s,{default:function(){return k}});var o=t(6252),n=t(9963);const a={class:"body"},i={class:"container"},r={class:"row justify-content-center"},c=(0,o._)("h1",{class:"h3 mb-3 font-weight-normal"},"請先登入",-1),u={class:"col-8"},d={class:"mb-3"},h={for:"username"},l={class:"mb-3"},p={for:"password"},m=(0,o._)("button",{class:"btn btn-lg btn-dark w-50 mt-1",type:"submit"}," 登入 ",-1),g=(0,o._)("p",{class:"mt-5 mb-3 text-muted"},"© 2022~∞ - DDDDK",-1);function v(e,s,t,v,w,f){const b=(0,o.up)("MyLoading");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("div",i,[(0,o.Wm)(b,{active:w.isLoading,"z-index":1060},null,8,["active"]),(0,o._)("div",r,[c,(0,o._)("div",u,[(0,o._)("form",{id:"form",class:"form-signin",onSubmit:s[2]||(s[2]=(0,n.iM)(((...e)=>f.Login&&f.Login(...e)),["prevent"]))},[(0,o._)("div",d,[(0,o._)("label",h,[(0,o.wy)((0,o._)("input",{type:"email",class:"form-control",id:"username",placeholder:"name@example.com",required:"","onUpdate:modelValue":s[0]||(s[0]=e=>w.user.username=e)},null,512),[[n.nr,w.user.username]])])]),(0,o._)("div",l,[(0,o._)("label",p,[(0,o.wy)((0,o._)("input",{type:"password",class:"form-control",id:"password",placeholder:"Password",required:"","onUpdate:modelValue":s[1]||(s[1]=e=>w.user.password=e)},null,512),[[n.nr,w.user.password]])])]),m],32)])]),g])])}var w={data(){return{isLoading:!1,user:{username:"",password:""}}},methods:{Login(){const e="https://vue3-course-api.hexschool.io/v2/admin/signin";this.$http.post(e,this.user).then((e=>{const{token:s,expired:t}=e.data;document.cookie=`hexToken=${s};expires=${new Date(t)};path=/;`,this.isLoading=!1,this.$router.push("/admin/products")})).catch((e=>{this.isLoading=!1,this.$httpMessageState(e.response,"登入")}))},checkLogin(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=e;const s="https://vue3-course-api.hexschool.io/v2/api/user/check";this.$http.post(s).then((e=>{console.log(e.data),this.$httpMessageState(e,"登入"),this.$router.push("/admin")})).catch((e=>{this.$router.push("/login"),this.$httpMessageState(e.response,"錯誤訊息")}))}},created(){this.checkLogin()}},f=t(3744);const b=(0,f.Z)(w,[["render",v]]);var k=b}}]);
//# sourceMappingURL=182.00e99baf.js.map